// /**
//  * Copyright Â© 2015 Magento. All rights reserved.
//  * See COPYING.txt for license details.
//  */

//
//  Navigation
//  _____________________________________________

@mixin lib-main-navigation(
    $_nav__indent-side                       : 15px,
    $_nav-background-color                   : $secondary__color__light,
    $_nav-border                             : '',
    $_nav-level0-font-size                   : 16,
    $_nav-level0-font-weight                 : $font-weight__bold,
    $_nav-level0-item-line-height            : false,
    $_nav-level0-item-margin                 : 0,
    $_nav-level0-item-padding                : 8px $indent__xl 8px 15px,
    $_nav-level0-text-transform              : uppercase,

    $_nav-level0-item-background-color       : '',
    $_nav-level0-item-border                 : 1px solid $color-gray82,
    $_nav-level0-item-color                  : $color-gray34,
    $_nav-level0-item-text-decoration        : none,

    $_nav-level0-item-background-color-active: '',
    $_nav-level0-item__active__border-color  : $color-orange-red1,
    $_nav-level0-item__active__border-style  : solid,
    $_nav-level0-item__active__border-width  : 0 0 0 8px,
    $_nav-level0-item-color-active           : '',
    $_nav-level0-item-text-decoration-active : '',

    $_submenu-background-color               : '',
    $_submenu-border                         : '',
    $_submenu-font-size                      : '',
    $_submenu-font-weight                    : $font-weight__regular,
    $_submenu-line-height                    : 1.3,
    $_submenu-item__padding-top              : $indent__s,
    $_submenu-item__padding-right            : 0,
    $_submenu-item__padding-bottom           : $indent__s,
    $_submenu-item__padding-left             : 15px,

    $_submenu-item-background-color          : '',
    $_submenu-item-border                    : '',
    $_submenu-item-color                     : $color-gray34,
    $_submenu-item-text-decoration           : '',

    $_submenu-item-background-color-active   : '',
    $_submenu-item__active__border           : 8px,
    $_submenu-item__active__border-color     : $color-orange-red1,
    $_submenu-item__active__border-style     : solid,
    $_submenu-item__active__border-width     : 0 0 0 8px,
    $_submenu-item-color-active              : '',
    $_submenu-item-text-decoration-active    : ''
) {
    .navigation {
        @include lib-css(background, $_nav-background-color);
        @include lib-css(border, $_nav-border);
        box-sizing: border-box;

        ul {
            margin: 0;
            padding: 0;
        }

        li {
            margin: 0;
        }

        a {
            display: block;
            @include lib-css(padding-top, $_submenu-item__padding-top);
            @include lib-css(padding-right, $_submenu-item__padding-right);
            @include lib-css(padding-bottom, $_submenu-item__padding-bottom);
            @include lib-css(padding-left, $_submenu-item__padding-left);
        }

        a,
        a:hover {
            @include lib-css(color, $_nav-level0-item-color);
            @include lib-css(text-decoration, $_nav-level0-item-text-decoration);
        }

        .level0 {
            @include lib-css(border-top, $_nav-level0-item-border);
            font-size: $_nav-level0-font-size;

            & > .level-top {
                @include lib-css(background, $_nav-level0-item-background-color);
                @include lib-css(font-weight, $_nav-level0-font-weight);
                @include lib-css(line-height, $_nav-level0-item-line-height);
                @include lib-css(padding, $_nav-level0-item-padding);
                @include lib-css(text-transform, $_nav-level0-text-transform);
                word-wrap: break-word;
            }

            &.active {
                .all-category {
                    .ui-state-focus {
                        @include lib-css(background, $_nav-level0-item-background-color-active);
                        @include lib-css(border-color, $_nav-level0-item__active__border-color);
                        @include lib-css(border-style, $_nav-level0-item__active__border-style);
                        @include lib-css(border-width, $_nav-level0-item__active__border-width);
                        @include lib-css(color, $_nav-level0-item-color-active);
                        @include lib-css(padding-left, $_nav__indent-side - $_submenu-item__active__border);
                        @include lib-css(text-decoration, $_nav-level0-item-text-decoration-active);
                        display: inline-block;
                    }
                }
            }

            & > .level1 {
                @include lib-css(font-weight, $font-weight__semibold);
            }

            &.active,
            &.has-active { // ToDo UI: remove "has_active" here, when mobile navigation default open state is implemented
                & > a:not(.ui-state-active) {
                    @include lib-css(background, $_nav-level0-item-background-color-active);
                    @include lib-css(border-color, $_nav-level0-item__active__border-color);
                    @include lib-css(border-style, $_nav-level0-item__active__border-style);
                    @include lib-css(border-width, $_nav-level0-item__active__border-width);
                    @include lib-css(color, $_nav-level0-item-color-active);
                    @include lib-css(text-decoration, $_nav-level0-item-text-decoration-active);

                    span:not(.ui-menu-icon) {
                        @include lib-css(margin-left, -$_submenu-item__active__border);
                    }
                }
            }
        }

        li.level0 {
            &:last-child {
                @include lib-css(border-bottom, $_nav-level0-item-border);
            }
        }

        .submenu {
            & > li {
                word-wrap: break-word;
            }

            &:not(:first-child) {
                @include lib-css(background, $_submenu-background-color);
                @include lib-css(border, $_submenu-border);
                @include lib-css(font-size, $_submenu-font-size);
                @include lib-css(font-weight, $_submenu-font-weight);
                @include lib-css(line-height, $_submenu-line-height);
                left: auto !important;
                overflow-x: hidden;
                padding: 0;
                position: relative;
                top: auto !important;
                transition: left .3s ease-out;

                & > li {
                    & > a {
                        @include lib-css(padding-left, $_nav__indent-side);
                    }

                    &:last-child {
                        margin-bottom: 0;
                    }
                }

                ul {
                    display: block;
                    @include lib-css(padding-left, $_submenu-item__padding-left);

                    & > li {
                        margin: 0;

                        a {
                            @include lib-css(background, $_submenu-item-background-color);
                            @include lib-css(border, $_submenu-item-border);
                            @include lib-css(color, $_submenu-item-color);
                            @include lib-css(text-decoration, $_submenu-item-text-decoration);
                            display: block;
                            line-height: normal;
                        }
                    }
                }

                &.expanded {
                    display: block !important;
                    padding-right: 0;
                    top: 0 !important;
                }

                .active {
                    & > a {
                        @include lib-css(background, $_submenu-item-background-color-active);
                        @include lib-css(border-color, $_submenu-item__active__border-color);
                        @include lib-css(border-style, $_submenu-item__active__border-style);
                        @include lib-css(border-width, $_submenu-item__active__border-width);
                        @include lib-css(color, $_submenu-item-color-active);
                        @include lib-css(padding-left, $_nav__indent-side - $_submenu-item__active__border);
                        @include lib-css(text-decoration, $_submenu-item-text-decoration-active);
                    }
                }

                .level1 {
                    &.active {
                        & > a {
                            @include lib-css(padding-left, $_nav__indent-side - $_submenu-item__active__border);
                        }
                    }
                }
            }
        }
    }
}

//
//  Desktop
//  _____________________________________________

@mixin lib-main-navigation-desktop(
    $_nav-background-color                   : $navigation__background,
    $_nav-border                             : '',
    $_nav-font-size                          : '',
    $_nav-font-weight                        : $font-weight__bold,

    $_nav-level0-item-line-height            : 53px,
    $_nav-level0-item-margin                 : 0 $indent__s 0 0,
    $_nav-level0-item-padding                : 0 12px,

    $_nav-level0-item-background-color       : '',
    $_nav-level0-item-border                 : '',
    $_nav-level0-item-color                  : $color-gray34,
    $_nav-level0-item-text-decoration        : none,

    $_nav-level0-item-background-color-hover : '',
    $_nav-level0-item-border-hover           : '',
    $_nav-level0-item-color-hover            : $primary__color,
    $_nav-level0-item-text-decoration-hover  : $navigation-desktop-level0-item__text-decoration,

    $_nav-level0-item-background-color-active: '',
    $_nav-level0-item__active__border-color  : $color-orange-red1,
    $_nav-level0-item__active__border-style  : solid,
    $_nav-level0-item__active__border-width  : 0 0 3px,
    $_nav-level0-item-color-active           : $navigation-desktop-level0-item__hover__color,
    $_nav-level0-item-text-decoration-active : $navigation-desktop-level0-item__text-decoration,

    $_submenu-background-color               : $page__background-color,
    $_submenu-border-width                   : $border-width__base,
    $_submenu-border-style                   : solid,
    $_submenu-border-color                   : $border-color__base,
    $_submenu-box-shadow                     : 0 $indent__xs $indent__xs rgba(0, 0, 0, 0.19),
    $_submenu-font-size                      : '',
    $_submenu-font-weight                    : $font-weight__bold,
    $_submenu-min-width                      : 230px,
    $_submenu-padding                        : 15px 0,

    $_submenu-arrow                          : true, // [true|false],
    $_submenu-arrow-size                     : 10px,
    $_submenu-arrow-left                     : 20px,

    $_submenu-item-padding                   : 8px $indent__base,
    $_submenu-item-background-color          : '',
    $_submenu-item-border                    : '',
    $_submenu-item-color                     : $navigation-desktop-level0-item__color,
    $_submenu-item-text-decoration           : '',

    $_submenu-item__hover__background-color  : $secondary__color,
    $_submenu-item-border-hover              : '',
    $_submenu-item-color-hover               : $navigation-desktop-level0-item__hover__color,
    $_submenu-item-text-decoration-hover     : $navigation-desktop-level0-item__text-decoration,

    $_submenu-item-background-color-active   : '',
    $_submenu-item__active__border-color     : $color-orange-red1,
    $_submenu-item__active__border-style     : solid,
    $_submenu-item__active__border-width     : 0 0 0 3px,
    $_submenu-item-color-active              : '',
    $_submenu-item-text-decoration-active    : ''
) {

    .navigation {
        @include lib-css(background, $_nav-background-color);
        @include lib-css(border, $_nav-border);
        @include lib-css(font-size, $_nav-font-size);
        @include lib-css(font-weight, $_nav-font-weight);
        height: inherit;
        left: auto;
        overflow: inherit;
        padding: 0;
        position: relative;
        top: 0;
        width: 100%;
        z-index: 3;

        &:empty {
            display: none;
        }

        ul {
            margin-top: 0;
            margin-bottom: 0;
            padding: 0;
            position: relative;
        }

        li.level0 {
            @include lib-css(border-top, none);
        }

        .level0 {
            @include lib-css(margin, $_nav-level0-item-margin);
            display: inline-block;
            position: relative;

            &:last-child {
                margin-right: 0;
                padding-right: 0;
            }

            & > .level-top {
                @include lib-css(background, $_nav-level0-item-background-color);
                @include lib-css(border, $_nav-level0-item-border);
                @include lib-css(color, $_nav-level0-item-color);
                @include lib-css(line-height, $_nav-level0-item-line-height);
                @include lib-css(padding, $_nav-level0-item-padding);
                @include lib-css(text-decoration, $_nav-level0-item-text-decoration);
                box-sizing: border-box;
                position: relative;

                &:hover, &.ui-state-focus {
                    @include lib-css(background, $_nav-level0-item-background-color-hover);
                    @include lib-css(border, $_nav-level0-item-border-hover);
                    @include lib-css(color, $_nav-level0-item-color-hover);
                    @include lib-css(text-decoration, $_nav-level0-item-text-decoration-hover);
                }
            }

            &.active,
            &.has-active {
                & > .level-top {
                    @include lib-css(background, $_nav-level0-item-background-color-active);
                    @include lib-css(border-color, $_nav-level0-item__active__border-color);
                    @include lib-css(border-style, $_nav-level0-item__active__border-style);
                    @include lib-css(border-width, $_nav-level0-item__active__border-width);
                    @include lib-css(color, $_nav-level0-item-color-active);
                    @include lib-css(text-decoration, $_nav-level0-item-text-decoration-active);
                    display: inline-block;
                }
            }

            &.parent:hover > .submenu {
                overflow: visible !important;
            }

            .submenu {
                @include lib-css(background, $_submenu-background-color);
                @include lib-css(border, $_submenu-border-width $_submenu-border-style $_submenu-border-color);
                @include lib-css(box-shadow, $_submenu-box-shadow);
                @include lib-css(font-size, $_submenu-font-size);
                @include lib-css(font-weight, $_submenu-font-weight);
                @include lib-css(min-width, $_submenu-min-width);
                @include lib-css(padding, $_submenu-padding);
                display: none;
                left: 0;
                margin: 0 !important;
                padding: 0;
                position: absolute;
                z-index: 1;

                @include _lib-submenu-arrow(
                    $_submenu-arrow,
                    $_bg    : $_submenu-background-color,
                    $_border: $_submenu-border-color,
                    $_size  : $_submenu-arrow-size,
                    $_left  : $_submenu-arrow-left
                );

                a {
                    display: block;
                    line-height: inherit;
                    @include lib-css(background, $_submenu-item-background-color);
                    @include lib-css(border, $_submenu-item-border);
                    @include lib-css(color, $_submenu-item-color);
                    @include lib-css(padding, $_submenu-item-padding);
                    @include lib-css(text-decoration, $_submenu-item-text-decoration);

                    &:hover,
                    &.ui-state-focus {
                        @include lib-css(background, $_submenu-item__hover__background-color);
                        @include lib-css(border, $_submenu-item-border-hover);
                        @include lib-css(color, $_submenu-item-color-hover);
                        @include lib-css(text-decoration, $_submenu-item-text-decoration-hover);
                    }
                }

                .active > a {
                    @include lib-css(background, $_submenu-item-background-color-active);
                    @include lib-css(border-color, $_submenu-item__active__border-color);
                    @include lib-css(border-style, $_submenu-item__active__border-style);
                    @include lib-css(border-width, $_submenu-item__active__border-width);
                    @include lib-css(color, $_submenu-item-color-active);
                    @include lib-css(text-decoration, $_submenu-item-text-decoration-active);
                }

                .submenu {
                    top: 0 !important;
                    left: 100% !important;
                }

                .submenu-reverse{
                    left: auto !important;
                    right: 100%;
                }
            }

            &.more {
                position: relative;
                @include lib-icon-font(
                    $icon-pointer-down,
                    $_icon-font-size: 26px,
                    $_icon-font-position: after
                );

                &:before {
                    display: none;
                }

                &:after {
                    cursor: pointer;
                    padding: 8px 12px;
                    position: relative;
                    z-index: 1;
                }

                &:hover > .submenu {
                    overflow: visible !important;
                }

                li {
                    display: block;
                }
            }
        }
    }
}

//  Submenu arrow
@mixin _lib-submenu-arrow(
    $_submenu-arrow,
    $_bg,
    $_border,
    $_size,
    $_left
) {
    @if $_submenu-arrow == true {
        @if iscolor($_bg) && iscolor($_border) {
            $_outer-size: $_size + 1;
            $_outer-left: $_left - 1;
            @include lib-css(margin-top, $_outer-size);

            > ul {
                @include lib-css(margin-top, $_outer-size);

                &:before,
                &:after {
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                }

                &:before {
                    @include lib-css(color, $_bg);
                    @include lib-css(left, $_left);
                    @include lib-css(top, -$_size*2);
                    @include lib-arrow(up, $_size, $_bg);
                    z-index: 4;
                }

                &:after {
                    @include lib-arrow(up, $_outer-size, $_border);
                    @include lib-css(color, $_border);
                    @include lib-css(left, $_outer-left);
                    @include lib-css(top, -$_outer-size*2);
                    z-index: 3;
                }
            }
        }
        @else if iscolor($_bg) && iscolor($_border) {
            @include lib-css(margin-top, -$_size);

            > ul {
                @include lib-css(margin-top, $_size);

                &:before {
                    @include lib-arrow(up, $_size, $_bg);
                    @include lib-css(color, $_bg);
                    @include lib-css(left, $_left);
                    @include lib-css(top, -$_size*2);
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                    z-index: 4;
                }
            }
        }
        @else if iscolor($_border) && iscolor($_bg) {
            @include lib-css(margin-top, -$_size);

            > ul {
                @include lib-css(margin-top, $_size);

                &:before {
                    @include lib-arrow(up, $_size, $_border);
                    @include lib-css(color, $_border);
                    @include lib-css(left, $_left);
                    @include lib-css(top, -$_size*2);
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                    z-index: 4;
                }
            }
        }
    }
}
